<div class='container px-5 px-sm-0'>
  <div class='row'>
    <div class='col-md-8 offset-md-1'>
      <h2>グループ詳細</h2>
      <table class='table table-hover table-inverse'>
        <thead>
          <tr>
            <th></th>
            <th>グループ名</th>
            <th>紹介文</th>
            <th colspan="3"></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <%= image_tag @group.get_group_image(50,50), class:"icon" %>
            </td>
            </td>
            <td><%= @group.name %></td>
            <td><%= @group.introduction %></td>
            <td>
              <% if @group.owner_id == current_customer.id %>
                <%= link_to 'Edit', edit_public_group_path(@group), class: "btn btn-sm btn-success" %>
              <% else %>

              <!--申請ボタン-->
                <% if @group_request.nil? %>
                  <%= button_to 'グループに申請', public_group_group_requests_path(@group), method: :post, class: "btn btn-primary" %>
                <% elsif @group_request.pending? %>
                  <p>申請中です。</p>
                <% elsif @group_request.approved? %>
                  <p>グループのメンバーです</p>
                <% elsif @group_request.rejected? %>
                  <p>申請が拒否されました。</p>
                <% end %>

              <% end %>
            </td>
          </tr>
        </tbody>
      </table>

      <h2>グループに所属している会員</h2>
      <table class="table table-hover table-inverse">
        <thead>
          <tr>
            <th>名前</th>
            <th>会員ステータス</th>
            <th colspan="3"></th>
          </tr>
        </thead>
          <tbody>
            <% @group_approved.each do |approved| %>
              <tr>
                <td>
                  <%= link_to public_customer_path(approved.customer), style:"text-decoration: none;" do %>
                    <%= image_tag approved.customer.get_profile_image(50,50), class:"icon" %>
                  <% end %>
                </td>
                <td><%= link_to approved.customer.name, public_customer_path(approved.customer) %></td>
                <td><%= approved.customer.is_active %></td>
              </tr>
            <% end %>
          </tbody>
       </table>

      <!--申請の管理-->
      <% if @group.owner == current_customer %>
        <h3>申請の管理</h3>
        <table class='table table-hover table-inverse'>
          <thead>
            <tr>
              <th>会員名</th>
              <th></th>
              <th></th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <% @group_requests.each do |request| %>
              <tr>
                <th>
                  <%= link_to public_customer_path(request.customer) do %>
                    <%= request.customer.name %>
                  <% end %>
                </th>
                <th>
                  <%= link_to '承認', public_group_group_request_path(@group.id, request.id, is_status: :approved), method: :patch, class: "btn btn-success" %>
                </th>
                <th>
                  <%= link_to '拒否', public_group_group_request_path(@group.id, request.id, is_status: :rejected), method: :patch, class: "btn btn-danger" %>
                </th>
              </tr>
            <% end %>
          </tbody>
        </table>

        <%= paginate @group_requests, theme: 'bootstrap-5' %>
      <% end %>
    </div>